<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸŒ² Wild Hunt Simulator</title>
  <style>
    body { margin:0; overflow:hidden; background:#000; }
    canvas { display:block; }
    #crosshair {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 18px; height: 18px;
      border: 2px solid red;
      border-radius: 50%;
      pointer-events: none;
    }
    #hud {
      position: fixed;
      top: 10px; left: 10px;
      color: white;
      font-family: monospace;
      font-size: 16px;
      background: rgba(0,0,0,0.6);
      padding: 8px 12px;
      border-radius: 8px;
      line-height: 1.5em;
    }
    #message {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      color: yellow;
      font-size: 32px;
      font-family: sans-serif;
      background: rgba(0,0,0,0.7);
      padding: 20px 30px;
      border-radius: 12px;
      display: none;
    }
  </style>
</head>
<body>
  <div id="crosshair"></div>
  <div id="hud">
    Health: <span id="health">100</span><br>
    Stamina: <span id="stamina">100</span><br>
    Ammo: <span id="ammo">5</span> / <span id="magazines">3</span><br>
    Score: <span id="score">0</span>
  </div>
  <div id="message"></div>

  <!-- Three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

  <script>
  function init(){
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.set(0,1.6,5);
    const renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // HUD
    const healthEl = document.getElementById("health");
    const staminaEl = document.getElementById("stamina");
    const ammoEl = document.getElementById("ammo");
    const magEl = document.getElementById("magazines");
    const scoreEl = document.getElementById("score");
    const messageEl = document.getElementById("message");

    let health = 100;
    let stamina = 100;
    let score = 0;
    let ammo = 5, maxAmmo = 5;
    let magazines = 3;

    // Lighting
    const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.8);
    hemiLight.position.set(0,20,0);
    scene.add(hemiLight);
    const dirLight = new THREE.DirectionalLight(0xffffff, 0.6);
    dirLight.position.set(-3,10,-10);
    scene.add(dirLight);

    // Day/night cycle
    let time = 0;

    // Ground
    const groundGeo = new THREE.PlaneGeometry(300,300);
    const groundMat = new THREE.MeshLambertMaterial({color:0x228B22});
    const ground = new THREE.Mesh(groundGeo, groundMat);
    ground.rotation.x = -Math.PI/2;
    scene.add(ground);

    // Forest
    function spawnTree(x,z){
      const trunk = new THREE.Mesh(
        new THREE.CylinderGeometry(0.2,0.2,2),
        new THREE.MeshLambertMaterial({color:0x8B4513})
      );
      trunk.position.set(x,1,z);
      const leaves = new THREE.Mesh(
        new THREE.ConeGeometry(1.5,3,8),
        new THREE.MeshLambertMaterial({color:0x006400})
      );
      leaves.position.set(x,3,z);
      scene.add(trunk,leaves);
    }
    for(let i=0;i<200;i++){
      spawnTree((Math.random()-0.5)*280,(Math.random()-0.5)*280);
    }

    // Animals
    const animals = [];
    const animalTypes = [
      {name:"Deer", color:0x8B4513, size:[1,1,2], score:50, speed:0.03},
      {name:"Boar", color:0x555555, size:[1.2,1,1.5], score:30, speed:0.025},
      {name:"Rabbit", color:0xffffff, size:[0.5,0.5,0.5], score:10, speed:0.04},
      {name:"Wolf", color:0x333333, size:[1,1,1.8], score:80, speed:0.035, hostile:true}
    ];
    function spawnAnimal(){
      const type = animalTypes[Math.floor(Math.random()*animalTypes.length)];
      const geo = new THREE.BoxGeometry(...type.size);
      const mat = new THREE.MeshLambertMaterial({color:type.color});
      const mesh = new THREE.Mesh(geo,mat);
      mesh.position.set((Math.random()-0.5)*200, type.size[1]/2, (Math.random()-0.5)*200);
      mesh.userData = {type:type, direction:Math.random()*Math.PI*2};
      animals.push(mesh);
      scene.add(mesh);
    }
    for(let i=0;i<25;i++) spawnAnimal();

    // Shooting
    window.addEventListener("click", ()=>{
      if(ammo<=0) return;
      ammo--; ammoEl.textContent = ammo;

      const raycaster = new THREE.Raycaster();
      raycaster.setFromCamera({x:0,y:0}, camera);
      const hits = raycaster.intersectObjects(animals);
      if(hits.length>0){
        const target = hits[0].object;
        score += target.userData.type.score;
        scoreEl.textContent = score;
        scene.remove(target);
        animals.splice(animals.indexOf(target),1);
        spawnAnimal();
      }
    });

    // Reload
    window.addEventListener("keydown", e=>{
      if(e.code==="KeyR" && magazines>0 && ammo<maxAmmo){
        magazines--;
        ammo = maxAmmo;
        magEl.textContent = magazines;
        ammoEl.textContent = ammo;
      }
    });

    // Movement
    let keys = {};
    document.addEventListener("keydown", e=> keys[e.code]=true);
    document.addEventListener("keyup", e=> keys[e.code]=false);

    let pitch=0,yaw=0;
    document.body.requestPointerLock = document.body.requestPointerLock || document.body.mozRequestPointerLock;
    document.body.onclick = ()=>document.body.requestPointerLock();
    document.addEventListener("mousemove", e=>{
      if(document.pointerLockElement===document.body){
        yaw -= e.movementX*0.002;
        pitch -= e.movementY*0.002;
        pitch = Math.max(-Math.PI/2, Math.min(Math.PI/2, pitch));
      }
    });

    // Game loop
    function animate(){
      requestAnimationFrame(animate);

      // Day/night
      time += 0.001;
      const sky = Math.sin(time)*0.5+0.5;
      scene.background = new THREE.Color(`hsl(210,50%,${30+sky*50}%)`);

      // Movement
      const baseSpeed = 0.1;
      let speed = baseSpeed;
      if(keys["ShiftLeft"] && stamina>0){
        speed*=2; stamina-=0.5;
      } else {
        stamina = Math.min(100, stamina+0.2);
      }
      staminaEl.textContent = Math.floor(stamina);

      const forward = new THREE.Vector3(Math.sin(yaw),0,Math.cos(yaw));
      const right = new THREE.Vector3(forward.z,0,-forward.x);
      if(keys["KeyW"]) camera.position.addScaledVector(forward,-speed);
      if(keys["KeyS"]) camera.position.addScaledVector(forward,speed);
      if(keys["KeyA"]) camera.position.addScaledVector(right,-speed);
      if(keys["KeyD"]) camera.position.addScaledVector(right,speed);
      camera.rotation.set(pitch,yaw,0);

      // Animals
      animals.forEach(a=>{
        const type=a.userData.type;
        if(type.hostile){
          // Wolves chase
          const dx=camera.position.x-a.position.x;
          const dz=camera.position.z-a.position.z;
          const dist=Math.sqrt(dx*dx+dz*dz);
          if(dist<15){
            a.position.x += dx/dist*type.speed*2;
            a.position.z += dz/dist*type.speed*2;
            if(dist<1.5){
              health-=0.2;
              healthEl.textContent = Math.max(0,Math.floor(health));
              if(health<=0){ endGame("You were defeated!"); }
            }
          }
        }else{
          // Wander
          a.position.x += Math.cos(a.userData.direction)*type.speed;
          a.position.z += Math.sin(a.userData.direction)*type.speed;
          if(Math.random()<0.01) a.userData.direction += (Math.random()-0.5);
        }
      });

      // Win condition
      if(score>=500) endGame("You Win! Score: "+score);

      renderer.render(scene,camera);
    }
    animate();

    function endGame(text){
      messageEl.textContent = text;
      messageEl.style.display = "block";
      document.exitPointerLock();
      cancelAnimationFrame(animate);
    }

    window.addEventListener("resize", ()=>{
      camera.aspect=window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth,window.innerHeight);
    });
  }
  init();
  </script>
</body>
</html>
